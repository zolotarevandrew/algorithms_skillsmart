1) VerifyPersonGroup - Создание списка на верификацию
Предусловие - сохранен тип списка на верификацию в метаданных онбординга;
Постусловие - верификации созданы для конкретных персон;

Во всех вызовах это "соблюдается", НО сохранение типа списка на верификацию не делается внутри интерфейса, а явно вызывается перед вызовом VerifyPersonGroup. 

То есть, если мы забудем сохранить тип списка заранее, то все просто развалится.
Естественно - нигде в предусловиях, это явно не указано.

2) Create - создание досье для подписания

Предусловия
- подписант прошел верификацию;
- необходимые поля заполнены и имеют нужный формат;

Постусловие - процесс подписания создан;

Предусловие - первое предусловие проверяет только наличие верификации, но не проверяет пройдена ли она.
При этом в стыковке с другим кодом, поскольку передается id персоны, не проверяется есть ли у нее верификация в целом, что может не явным образом выстрелить в будущем.
 
А второе предусловие, проверяется всегда.

3) MarkAsRegistrator - пометка персоны регистратором

Предусловие - существует персона и онбординг;

Постусловие - персона помечена как регистратор и проставлена связь с user-ом, при этом среди списка персон, только одна является регистратором и она существует;

Предусловие и постусловие практически всегда выполняется, в связке с другим кодом.
Нашел место где постусловие может нарушиться
- персону могли удалить или ее не существует, а поскольку логика реализована на sql - update обработает 0 записей
и тогда не будет ни одного регистратора, а это приведет кучу проблем далее.

4) Block - Блокировка автоонбординга

Предусловие - существует досье клиента.

Постусловие - блокировка существует в списке блокировок.

Посмотрел места использования - может быть ситуация, когда предусловие не выполнится, досье клиента не существует, но онбординг надо все же заблокировать.
И здесь уже деталь реализации неверная, поскольку в спецификации такого не было, что блокировка привязывается к существующему досье, а не в целом к компании.

5) GetStep - получение следующего шага онбординга

Предусловие - триггеры на переходы по шагам существуют.
Постусловие - найден следующий шаг для перехода и он не равен текущему.

По местам использования все в рамках ожидаемого.


Итого - очень потрясает факт того, что неявная спецификация (несоблюдение пред/пост-условий и инвариантов) может
привести к серьезным багам, при этом их и отследить будет тяжело.
Возьму себе еще раз на заметку, несмотря на то что проходил курсы по ООАП, не сильно следил за спецификациями своего кода в последнее время. 











